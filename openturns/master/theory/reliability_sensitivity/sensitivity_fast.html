
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Sensivity analysis by Fourier decomposition &#8212; OpenTURNS  documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Importance factors from FORM method" href="importance_form.html" />
    <link rel="prev" title="Sensivity analysis with correlated inputs" href="sensitivity_ancova.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="http://trac.openturns.org">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="importance_form.html" title="Importance factors from FORM method"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sensitivity_ancova.html" title="Sensivity analysis with correlated inputs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Reference guide</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" accesskey="U">Reliability, sensitivity</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="sensitivity_ancova.html"
                        title="previous chapter">Sensivity analysis with correlated inputs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="importance_form.html"
                        title="next chapter">Importance factors from FORM method</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/reliability_sensitivity/sensitivity_fast.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sensivity-analysis-by-fourier-decomposition">
<h1>Sensivity analysis by Fourier decomposition<a class="headerlink" href="#sensivity-analysis-by-fourier-decomposition" title="Permalink to this headline">¶</a></h1>
<p>FAST is a sensitivity analysis method which is based upon the ANOVA
decomposition of the variance of the model response
<img class="math" src="../../_images/math/8d33b719538df83fd2bc88190bbc27abedaa8adc.svg" alt="y = f(\vect{X})"/>, the latter being represented by its Fourier
expansion. <img class="math" src="../../_images/math/4631f4b286e25163e69d7deaa8744830a2b8941f.svg" alt="\vect{X}=\{X^1,\dots,X^{n_X}\}"/> is an input random
vector of <img class="math" src="../../_images/math/4056a1b2001e6226d1044246e6813d2a3c90eb94.svg" alt="n_X"/> independent components.</p>
<div class="line-block">
<div class="line">The extended FAST method consists in computing
alternately the first order and the total-effect indices of each
input. This approach relies upon a Fourier decomposition of the model
response. Its key idea is to recast this representation as a function
of a <img class="math" src="../../_images/math/ccc2d1a8d6dadf7354d153aa74e911f450147d09.svg" alt="\mathit{scalar}"/> parameter <img class="math" src="../../_images/math/6152ab1727a5471b499b19f272492eb14272751c.svg" alt="s"/>, by defining
parametric curves <img class="math" src="../../_images/math/6ea11179d2230e568b98b664da256abf803996a7.svg" alt="s \mapsto x_i(s)"/>, <img class="math" src="../../_images/math/7104016307e6e5cf05b3ee5cbe8a06622edc907f.svg" alt="i=1, \dots, n_X"/>
exploring the support of the input random vector <img class="math" src="../../_images/math/3fdfffe1d843437fafd6881a099fdf19eff9e194.svg" alt="\vect{X}"/>.</div>
<div class="line">For each input, the same procedure is realized in three steps:</div>
</div>
<ul>
<li><p class="first">Sampling:</p>
<p>Deterministic space-filling paths with random starting points are
defined, i.e. each input <img class="math" src="../../_images/math/872e7272798823842a1309501c89acd170652ea8.svg" alt="X^i"/> is transformed as follows:</p>
<div class="math">
<p><img src="../../_images/math/16ce25410a40e0eaccb004ed651e067b2a1c4df8.svg" alt="x^i_j = \frac{1}{2} + \frac{1}{\pi} \arcsin(\sin(\omega_i s_j + \phi_i)),
    \quad i=1, \dots, n_X, \, j=1, \dots, N"/></p>
</div><p>where <img class="math" src="../../_images/math/4056a1b2001e6226d1044246e6813d2a3c90eb94.svg" alt="n_X"/> is the number of input variables. <img class="math" src="../../_images/math/590e62c4db8a892c9b9a0c6f58bb7e2f1ec99e9b.svg" alt="N"/> is the
length of the discretization of the s-space, with <img class="math" src="../../_images/math/6152ab1727a5471b499b19f272492eb14272751c.svg" alt="s"/> varying
in <img class="math" src="../../_images/math/e9be70e8ac82c21713f920bc3b1db1d307eb0feb.svg" alt="(-\pi, \pi)"/> by step of <img class="math" src="../../_images/math/4b30054afc07a7ba35a298ac46369127529e9b41.svg" alt="2\pi/N"/>. <img class="math" src="../../_images/math/a4fe8c87f8942ca7becd0a6956abb5f40bd8715d.svg" alt="\phi_i"/> is a
random phase-shift chosen uniformly in <img class="math" src="../../_images/math/7feaf79723b128e245da4ade3e03a30a9cd2897a.svg" alt="[0, 2\pi]"/> which
enables to make the curves start anywhere within the unit hypercube
<img class="math" src="../../_images/math/377d66452fcb741c22d412fdc8515acb9b58d2c9.svg" alt="K^{n_X}=(\vect{X}|0\leq x_i\leq1; i=1, \dots, n_X)"/>. The
selection of the set <img class="math" src="../../_images/math/c8595afeeaa7f9df137c944df00868505ea5c18d.svg" alt="\{\phi_1, \dots, \phi_{n_X}\}"/> induces a
part of randomness in the procedure. So it can be asked to realize
the procedure <img class="math" src="../../_images/math/797fcf6200143c73dd1ff775bb9715b86f9f21c1.svg" alt="Nr"/> times and then to calculate the arithmetic
means of the results over the <img class="math" src="../../_images/math/797fcf6200143c73dd1ff775bb9715b86f9f21c1.svg" alt="Nr"/> estimates. This operation is
called <img class="math" src="../../_images/math/92a61e0e897ed52bc1c4ff2886e0e475d4c67157.svg" alt="\mathit{resampling}"/>.</p>
<p><img class="math" src="../../_images/math/d70b84b5dd46400b4fe94e2863e418a883934488.svg" alt="\{\omega_i\}, \forall i=1, \dots, n_X"/> is a set of integer
frequencies assigned to each input <img class="math" src="../../_images/math/872e7272798823842a1309501c89acd170652ea8.svg" alt="X^i"/>. The frequency
associated with the input of interest is set to the maximum
admissible frequency satisfying the Nyquist criterion (which ensures
to avoid aliasing effects):</p>
<div class="math">
<p><img src="../../_images/math/a32e220c0d84e024d06c9c040c717673fa91c9fa.svg" alt="\omega_i = \frac{N - 1}{2M}"/></p>
</div><p>with <img class="math" src="../../_images/math/aadb4b560f4759eb199cb33c5eb662ffe016dc18.svg" alt="M"/> the interference factor usually equal to 4 or higher.
It corresponds to the truncation level of the Fourier series, i.e.
the number of harmonics that are retained in the decomposition
realized in the third step of the procedure.</p>
<p>In the paper <a class="reference internal" href="../../bibliography.html#saltelli1999" id="id1">[Saltelli1999]</a>, for high sample size, it is
suggested that <img class="math" src="../../_images/math/61624298d1e7080e1e4cc3494e9100604fa0c458.svg" alt="16 \leq \omega_i/N_r \leq 64"/>.</p>
<p>And the maximum frequency of the complementary set of frequencies is:</p>
<div class="math">
<p><img src="../../_images/math/50d22a61aab7d36596e2569de4a779211da4d9af.svg" alt="\max(\omega_{-i}) = \frac{\omega_i}{2M} = \frac{N - 1}{4M^2}"/></p>
</div><p>with the index ’<img class="math" src="../../_images/math/a56d837ea5e359e8477583f19e9c04c2b3b15aff.svg" alt="-i"/>’ which meaning ’all but <img class="math" src="../../_images/math/83a1929c1cd341d9476f20e34f0ca7ab802344c3.svg" alt="i"/>’.</p>
<p>The other frequencies are distributed uniformly between <img class="math" src="../../_images/math/f3d44eee68f965e0c3a97b452cb1cc2898b0cfdd.svg" alt="1"/> and
<img class="math" src="../../_images/math/72b3651aa5b7248deb359618df794ab8d59e36c7.svg" alt="\max(\omega_{-i})"/>. The set of frequencies is the same
whatever the number of resamplings is.</p>
<p>Let us make an example with eight input factors, <img class="math" src="../../_images/math/d2e26be17f43ba53d0a558562f0aff0367d44705.svg" alt="N=513"/> and
<img class="math" src="../../_images/math/f9c45d854a6ba6e74fe89e5359d807a5c9ce8fcf.svg" alt="M=4"/> i.e. <img class="math" src="../../_images/math/2be95345b74926f1fb76fe7c1b2531adef4a16d5.svg" alt="\omega_i = \frac{N - 1}{2M} = 64"/> and
<img class="math" src="../../_images/math/34d9982990e13845a4bbaa86dfc69d0c269dc460.svg" alt="\max(\omega_{-i}) = \frac{N - 1}{4M^2} = 8"/> with <img class="math" src="../../_images/math/83a1929c1cd341d9476f20e34f0ca7ab802344c3.svg" alt="i"/> the
index of the input of interest.</p>
<div class="line-block">
<div class="line">When computing the sensitivity indices for the first input, the
considered set of frequencies is :
<img class="math" src="../../_images/math/0e76f59265b0251564ac7d54e9a165fbfd90bf48.svg" alt="\{64, 1, 2, 3, 4, 5, 6, 8\}"/>.</div>
<div class="line">When computing the sensitivity indices for the second input, the
considered set of frequencies is :
<img class="math" src="../../_images/math/c8c514450d306ab957259c0e2236fe3b9d0a915c.svg" alt="\{1, 64, 2, 3, 4, 5, 6, 8\}"/>.</div>
<div class="line">etc.</div>
</div>
<p>The transformation defined above provides a uniformly distributed
sample for the <img class="math" src="../../_images/math/6be9a1384cae6e454dfb34d394db9defcb086bba.svg" alt="x_i, \forall i=1, \dots, n_X"/> oscillating
between <img class="math" src="../../_images/math/6770158f1fa6fb569a1764a8180650d5cfcea95c.svg" alt="0"/> and <img class="math" src="../../_images/math/f3d44eee68f965e0c3a97b452cb1cc2898b0cfdd.svg" alt="1"/>. In order to take into account the
real distributions of the inputs, we apply an isoprobabilistic
transformation on each <img class="math" src="../../_images/math/a88b146a7246b1488de7e4bffe4f375bb3bb7574.svg" alt="x_i"/> before the next step of the
procedure.</p>
</li>
<li><p class="first">Simulations:</p>
<p>Output is computed such as:
<img class="math" src="../../_images/math/12db63d8ae4b40d3b4ff94d7cc13b995b1503a78.svg" alt="y = f(s) = f(x_1(s), \dots, x_{n_X}(s))"/></p>
<p>Then <img class="math" src="../../_images/math/7d511b6f748d2bdf2c5e25631eab9e880bedec85.svg" alt="f(s)"/> is expanded onto a Fourier series:</p>
<div class="math">
<p><img src="../../_images/math/f26456762d269541714ada23ecabb0fbc18d2c36.svg" alt="f(s) = \sum_{k \in \Zset^N} A_k \cos(ks) + B_k \sin(ks)"/></p>
</div><p>where <img class="math" src="../../_images/math/5f6cf2dba652634f4bd408ba387cd89a259cffe9.svg" alt="A_k"/> and <img class="math" src="../../_images/math/61fdbca6ca34ebd9062d65b511102d7b36d78ef7.svg" alt="B_k"/> are Fourier coefficients defined as
follows:</p>
<div class="math">
<p><img src="../../_images/math/ef156b912e6c784b6eb402f0dafe39c19a3f86b2.svg" alt="\begin{aligned}
    A_k &amp;=&amp; \frac{1}{2\pi}\int_{-\pi}^{\pi}f(s) \cos(ks) \, ds \\
    B_k &amp;=&amp; \frac{1}{2\pi}\int_{-\pi}^{\pi}f(s) \sin(ks) \, ds
  \end{aligned}"/></p>
</div><p>These coefficients are estimated thanks to the following discrete
formulations:</p>
<div class="math">
<p><img src="../../_images/math/bb073ed11cea395396c16191aec4a2f3da557615.svg" alt="\begin{aligned}
    \hat{A}_k &amp;=&amp; \frac{1}{N} \sum_{j=1}^N f(x_j^1,\dots,x_j^{N_X}) cos \left( \frac{2k\pi (j-1)}{N} \right) \quad , \quad -\frac{N}{2} \leq k \leq \frac{N}{2}\\
    \hat{B}_k &amp;=&amp; \frac{1}{N} \sum_{j=1}^N f(x_j^1,\dots,x_j^{N_X}) sin \left( \frac{2k\pi (j-1)}{N} \right) \quad , \quad -\frac{N}{2} \leq k \leq \frac{N}{2}
  \end{aligned}"/></p>
</div></li>
<li><p class="first">Estimations by frequency analysis:</p>
<p>The first order indices are estimated as follows:</p>
<div class="math">
<p><img src="../../_images/math/4fda07186c4e69dbe7a9a891a1044c5097667837.svg" alt="\hat{S}_i = \frac{\hat{D}_i}{\hat{D}} \\
              = \frac{\sum_{p=1}^M(\hat{A}_{p\omega_i}^2 + \hat{B}_{p\omega_i}^2)^2}
                     {\sum_{n=1}^{(N-1)/2}(\hat{A}_n^2 + \hat{B}_n^2)^2}"/></p>
</div><p>where <img class="math" src="../../_images/math/2cc31248a8c57a9de2f4452c86fb49aee1b00eac.svg" alt="\hat{D}"/> is the total variance and <img class="math" src="../../_images/math/7e8ffd450f49fbfe56c6334503933f2113d6a264.svg" alt="\hat{D}_i"/> the
portion of <img class="math" src="../../_images/math/a2a26d140557e51a246c91a2c6ca944d733b12e8.svg" alt="D"/> arising from the uncertainty of the
<img class="math" src="../../_images/math/9b3fb7e041ddeea31ab9148572d497bf4e51c592.svg" alt="i^{th}"/> input. <img class="math" src="../../_images/math/590e62c4db8a892c9b9a0c6f58bb7e2f1ec99e9b.svg" alt="N"/> the size of the sample using to
compute the Fourier series and <img class="math" src="../../_images/math/aadb4b560f4759eb199cb33c5eb662ffe016dc18.svg" alt="M"/> is the interference factor.
Saltelli et al. (1999) recommanded to set <img class="math" src="../../_images/math/aadb4b560f4759eb199cb33c5eb662ffe016dc18.svg" alt="M"/> to a value in the
range <img class="math" src="../../_images/math/480d06c12339af6b09f19da76ba062aa35bee2df.svg" alt="[4, 6]"/>.</p>
<p>The total order indices are estimated as follows:</p>
<div class="math">
<p><img src="../../_images/math/fe3695d89ff01b298ae67a76e289d41f5d62f49b.svg" alt="\hat{T}_i = 1 - \frac{\hat{D}_{-i}}{\hat{D}} \\
              = 1 - \frac{\sum_{k=1}^{\omega_i/2}(\hat{A}_k^2 + \hat{B}_k^2)^2}
                         {\sum_{n=1}^{(N-1)/2}(\hat{A}_n^2 + \hat{B}_n^2)^2}"/></p>
</div><p>where <img class="math" src="../../_images/math/38f64206561ff452fd33862ea647530eac347eaf.svg" alt="\hat{D}_{-i}"/> is the part of the variance due to all the
inputs except the <img class="math" src="../../_images/math/9b3fb7e041ddeea31ab9148572d497bf4e51c592.svg" alt="i^{th}"/> input.</p>
</li>
</ul>
<div class="topic">
<p class="topic-title first">API:</p>
<ul class="simple">
<li>See <a class="reference internal" href="../../user_manual/_generated/openturns.FAST.html#openturns.FAST" title="openturns.FAST"><code class="xref py py-class docutils literal notranslate"><span class="pre">FAST</span></code></a></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li>See <a class="reference internal" href="../../examples/reliability_sensitivity/sensitivity_fast.html"><span class="doc">FAST sensitivity indices</span></a></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><a class="reference internal" href="../../bibliography.html#saltelli1999" id="id2">[Saltelli1999]</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="importance_form.html" title="Importance factors from FORM method"
             >next</a> |</li>
        <li class="right" >
          <a href="sensitivity_ancova.html" title="Sensivity analysis with correlated inputs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Reference guide</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" >Reliability, sensitivity</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2018 Airbus-EDF-IMACS-Phimeca.
      Last updated on Jan 01, 2018.
    </div>
  </body>
</html>