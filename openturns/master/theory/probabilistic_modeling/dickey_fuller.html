
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Dickey-Fuller stationarity test &#8212; OpenTURNS  documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Meta modeling" href="../meta_modeling/meta_modeling.html" />
    <link rel="prev" title="Process transformation" href="process_transformation.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="http://trac.openturns.org">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../meta_modeling/meta_modeling.html" title="Meta modeling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="process_transformation.html" title="Process transformation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="probabilistic_modeling.html" accesskey="U">Probabilistic modeling</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="process_transformation.html"
                        title="previous chapter">Process transformation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../meta_modeling/meta_modeling.html"
                        title="next chapter">Meta modeling</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/probabilistic_modeling/dickey_fuller.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dickey-fuller-stationarity-test">
<span id="dickey-fuller"></span><h1>Dickey-Fuller stationarity test<a class="headerlink" href="#dickey-fuller-stationarity-test" title="Permalink to this headline">¶</a></h1>
<p>The Dickey-Fuller test checks the stationarity of a scalar time series using one time series. It assumes that the <img class="math" src="../../_images/math/df5997544c63894452a08fa1d97784d99415412e.svg" alt="X: \Omega \times \cD \rightarrow \Rset"/> process with <img class="math" src="../../_images/math/f17588104c11a26fea489512b81595fe5fd3e72f.svg" alt="\cD \in \Rset"/>, discretized on the time grid <img class="math" src="../../_images/math/cd8d5e7dcea11d7f0b25dd0d546512ce990367c5.svg" alt="(t_0, \dots, t_{N-1})"/> writes:</p>
<div class="math" id="equation-dfmodel">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-dfmodel" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d8e97ad554e1a9910e34af6889790f00fd7a9898.svg" alt="X_t = a + bt + \rho X_{t-1} + \varepsilon_{t}"/></p>
</div><p>where <img class="math" src="../../_images/math/0e97836e1f762c314ab3efcfa63eb924a18c3511.svg" alt="\rho &gt; 0"/> and where <img class="math" src="../../_images/math/69f1be4af39fdd172c6af6b4eff109ffa69e5b80.svg" alt="a"/> or <img class="math" src="../../_images/math/7a28565e2d8a0f1b90383ada07f80ec18c374992.svg" alt="b"/> or both <img class="math" src="../../_images/math/a9424167f6936d0e0f6e30ce5b3d8446e12e3c21.svg" alt="(a,b)"/> can be assumed to be equal to 0.</p>
<p>The Dickey-Fuller test checks whether the random perturbation at time <img class="math" src="../../_images/math/eb169b6b0e185fc9abf4111d16ceb787a940d013.svg" alt="t"/> vanishes with time.</p>
<p>When <img class="math" src="../../_images/math/64027f02e69eec9bd6d73fb54ab74f2677ee32a7.svg" alt="a \neq 0"/> and <img class="math" src="../../_images/math/14dfcca6198ac80d88ef1edc17bbdfd0a8dcaf11.svg" alt="b=0"/>, the model <a class="reference internal" href="#equation-dfmodel">(1)</a> is said to have a <em>drift</em>. When <img class="math" src="../../_images/math/5ad96240e70a8291cacb32cc7e78bbfa0e13d619.svg" alt="a = 0"/> and <img class="math" src="../../_images/math/a1b38c6e7a52fbe21250eb1f5c30d883559fbcf4.svg" alt="b \neq 0"/>, the model <a class="reference internal" href="#equation-dfmodel">(1)</a> is said to have a <em>linear trend</em>.</p>
<p>In the model <a class="reference internal" href="#equation-dfmodel">(1)</a>, the only way to have stochastic non stationarity is to have <img class="math" src="../../_images/math/5bdd3cbf849b7e787a0b6bb512eb100fa651e750.svg" alt="\rho = 1"/> (if <img class="math" src="../../_images/math/8c6e0a9837c9eb9ef8d004e1c9f3dcceed4dd2bf.svg" alt="\rho &gt; 1"/>, then the process diverges with time which is readily seen in the data). In the general case, the Dickey-Fuller test is a unit root test to detect whether <img class="math" src="../../_images/math/52099707c06688f13c0e16fef477967a64a41f5c.svg" alt="\rho=1"/> against <img class="math" src="../../_images/math/086af165e19fd35175fffae6670422fcbea0cf82.svg" alt="\rho &lt; 1"/>:</p>
<p>The test statistics and its limit distribution depend on the a priori knowledge we have on <img class="math" src="../../_images/math/69f1be4af39fdd172c6af6b4eff109ffa69e5b80.svg" alt="a"/> and <img class="math" src="../../_images/math/7a28565e2d8a0f1b90383ada07f80ec18c374992.svg" alt="b"/>. In case of absence of a priori knowledge on the structure of the model, several authors have proposed a global strategy to cover all the subcases of the model <a class="reference internal" href="#equation-dfmodel">(1)</a>, depending on the possible values on <img class="math" src="../../_images/math/69f1be4af39fdd172c6af6b4eff109ffa69e5b80.svg" alt="a"/> and <img class="math" src="../../_images/math/7a28565e2d8a0f1b90383ada07f80ec18c374992.svg" alt="b"/>.</p>
<p>The strategy implemented is recommended by Enders (<em>Applied Econometric Times Series</em>, Enders, W., second edition, John Wiley &amp; sons editions, 2004.).</p>
<p>We note <img class="math" src="../../_images/math/03d6cf86175468b4649de8c053632fc4b36f1b03.svg" alt="(X_1, \hdots, X_n)"/> the data, by <img class="math" src="../../_images/math/a888e3f7b825b4c54951cec471da7391cb5ebe85.svg" alt="W(r)"/> the Wiener process, and <img class="math" src="../../_images/math/2ba3caf9ad61a7df9b9753dc84ed47458896ba40.svg" alt="W^{a}(r) = W(r) - \int_{0}^{1} W(r)\di{r}"/>, <img class="math" src="../../_images/math/068cc7a13540fd572fb6d0bed81e30a43a4d2895.svg" alt="W^{b}(r) = W^{a}(r) - 12 \left(r - \frac{1}{2} \right) \int_{0}^{1} \left(s - \frac{1}{2} \right) W(s)\di{s}"/>.</p>
<p><strong>1.</strong> We assume the model <a class="reference internal" href="#equation-model1">(2)</a>:</p>
<div class="math" id="equation-model1">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-model1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/8564db675c3a44b27f1588f8af6b1c641db98cb8.svg" alt="\boldsymbol{X_t = a + bt + \rho X_{t-1} + \varepsilon_{t}}"/></p>
</div><p>The coefficients <img class="math" src="../../_images/math/fe7f107b18fdbe376f1cec2ca3a5e05691ac169e.svg" alt="(a,b,\rho)"/> are estimated by <img class="math" src="../../_images/math/3f34203a5262c866c95ce96d8922697d4b2bd2aa.svg" alt="(\Hat{a}_n, \Hat{b}_n, \Hat{\rho}_n)"/> using ordinary least-squares fitting, which leads to:</p>
<div class="math" id="equation-model1estim">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-model1estim" title="Permalink to this equation">¶</a></span><img src="../../_images/math/6bf4b159d169939a4848320f1f47ff4b9e689528.svg" alt="\underbrace{\left(
   \begin{array}{lll}
     \displaystyle n-1 &amp;\sum_{i=1}^n t_{i} &amp;\sum_{i=2}^n y_{i-1}\\
     \displaystyle \sum_{i=1}^n t_{i} &amp;\sum_{i=1}^n t_{i}^2 &amp;\sum_{i=2}^n t_{i} y_{i-1}\\
     \displaystyle \sum_{i=2}^n y_{i-1}&amp; \sum_{i=2}^n t_{i}y_{i-1} &amp;\sum_{i=2}^n y_{i-1}^2
   \end{array}
   \right)}_{\mat{M}}
 \left(
   \begin{array}{c}
    \hat{a}_n\\
    \hat{b}_n\\
    \hat{\rho}_n
   \end{array}
 \right)=
 \left(
 \begin{array}{l}
   \displaystyle \sum_{i=1}^n y_{i} \\
   \displaystyle \sum_{i=1}^n t_{i} y_{i}\\
   \displaystyle \sum_{i=2}^n y_{i-1} y_{i}
 \end{array}
 \right)"/></p>
</div><p>We first test:</p>
<div class="math" id="equation-testmodel1">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-testmodel1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/e009c8ec452f1ea8d7b3d706a6585c2ef3a46d0b.svg" alt="\left\{
\begin{array}{lr}
  \cH_0: &amp; \rho = 1 \\
  \cH_1: &amp; \rho &lt; 1
\end{array}
\right."/></p>
</div><p>thanks to the Student statistics:</p>
<div class="math">
<p><img src="../../_images/math/657adc23112e9a54662dd65edf38d26ba1fd2942.svg" alt="t_{\rho=1} = \frac{\rho_n-1}{\hat{\sigma}_{\rho_n}}"/></p>
</div><p>where <img class="math" src="../../_images/math/512e96c686a4fd1776c3ffd78b50b21cb199c029.svg" alt="\sigma_{\rho_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/253f79e431ebb1120f97e2ce9b8c8d6a83351700.svg" alt="\Hat{\rho}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/498eb98d169762551efa6d90ad035e2de3a5e941.svg" alt="\sigma_{\rho_n}=\mat{M}^{-1}_{33}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{b}_nt_i+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><p>which converges in distribution to the Dickey-Fuller distribution associated to the model with drift and trend:</p>
<div class="math">
<p><img src="../../_images/math/7883225d42600a75f1526e8d98368cbed4f2c577.svg" alt="t_{\rho = 1} \stackrel{\mathcal{L}}{\longrightarrow} \frac{\int_{0}^{1}W^{b}(r) \di{W(r)}}{\int_{1}^{0} W^{b}(r)^2 \di{r}}"/></p>
</div><p>The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted when <img class="math" src="../../_images/math/af3ba8266e948cfd29ef8a4bd948d6d9e1e9765d.svg" alt="t_{\rho=1} &gt; C_{\alpha}"/> where <img class="math" src="../../_images/math/8683399d17ea6912bd9218714c693981d1c45c7d.svg" alt="C_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/76b5e485f3e9e29ec4dde654fb6b9d110213a6f5.svg" alt="\alpha"/>.</p>
<p>The quantiles of the Dickey-Fuller statistics for the model with drift and linear trend are:</p>
<div class="math">
<p><img src="../../_images/math/ba9a95e845c7cee32b6410bbc392c71dd47e9796.svg" alt="\left\{
\begin{array}{ll}
    \alpha = 0.01, &amp; C_{\alpha} = -3.96 \\
    \alpha = 0.05, &amp; C_{\alpha} = -3.41 \\
    \alpha = 0.10, &amp; C_{\alpha} = -3.13
\end{array}
\right."/></p>
</div><p><strong>1.1. Case 1:</strong> The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is rejected</p>
<p>We test whether <img class="math" src="../../_images/math/14dfcca6198ac80d88ef1edc17bbdfd0a8dcaf11.svg" alt="b=0"/>:</p>
<div class="math" id="equation-testsousmodele1-1">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-testsousmodele1-1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b6774846fab60a44297cda60838c0a31950b9fc6.svg" alt="\left\{
\begin{array}{lr}
  \cH_0: &amp; b = 0 \\
  \cH_1: &amp; b \neq 0
\end{array}
\right."/></p>
</div><p>where the statistics <img class="math" src="../../_images/math/d84cd403fbc85faddf8d03232e81ddc45a786210.svg" alt="t_n = \frac{|\hat{b}_n|}{\sigma_{b_n}}"/> converges in distribution to the Student distribution <a class="reference internal" href="../../user_manual/_generated/openturns.Student.html#openturns.Student" title="openturns.Student"><code class="xref py py-class docutils literal notranslate"><span class="pre">Student</span></code></a> with <img class="math" src="../../_images/math/05ef0f4fd83b03302a85d607347800b4283efc12.svg" alt="\nu=n-4"/>, where <img class="math" src="../../_images/math/3fcaa006c6ca2ad9aa4e60ce55588c2314180424.svg" alt="\sigma_{b_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/41fbe57e91f4d93f49b411d2776d7ad26c401a34.svg" alt="\Hat{b}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/559bdee5cef299212f68c063b4f3565344ce95ee.svg" alt="\sigma_{b_n}=\mat{M}^{-1}_{22}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{b}_nt_i+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><dl class="docutils">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-1">(5)</a> is rejected, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is confirmed. And the test <a class="reference internal" href="#equation-testmodel1">(4)</a> proved that the unit root is rejected : <img class="math" src="../../_images/math/086af165e19fd35175fffae6670422fcbea0cf82.svg" alt="\rho &lt; 1"/>. We then conclude that the final model is : <img class="math" src="../../_images/math/6358378fcebf0f105501fed0b1ce55499c691c3a.svg" alt="\boldsymbol{X_t = a + bt + \rho X_{t-1} + \varepsilon_{t}}"/> with <img class="math" src="../../_images/math/3627c584f936a8be950e9a40ec981345b6e68ead.svg" alt="\boldsymbol{\rho &lt; 1}"/> which is a <strong>trend stationary model</strong>.</li>
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-1">(5)</a> is accepted, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is not confirmed, since the trend presence is rejected and the test <a class="reference internal" href="#equation-testmodel1">(4)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the second model</strong> <a class="reference internal" href="#equation-model2">(7)</a>.</li>
</ul>
</dd>
</dl>
<p><strong>1.2. Case 2:</strong> The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted</p>
<p>We test whether <img class="math" src="../../_images/math/3aa2c08be0c8a472fe28596b1c81e2d303ed2fb2.svg" alt="(\rho, b) = (1,0)"/>:</p>
<div class="math" id="equation-testsousmodele1-2">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-testsousmodele1-2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/e294d5f1e6cb7e7277e82e40b55ba55408e76fec.svg" alt="\left\{
\begin{array}{lr}
  \cH_0: &amp; (\rho, b) = (1,0) \\
  \cH_1: &amp; (\rho, b) \neq (1,0)
\end{array}
\right."/></p>
</div><p>with the Fisher statistics:</p>
<div class="math">
<p><img src="../../_images/math/c238dc4d7e2eaab73388c323452eeba2b2286e34.svg" alt="\displaystyle \hat{F}_1 = \frac{(S_{1,0} - S_{1,b})/2}{S_{1,b}/(n-3)}"/></p>
</div><p>where <img class="math" src="../../_images/math/f4ee4796a0e712c56bf20695998cee60074bef2a.svg" alt="S_{1,0}=\sum_{i=2}^n\left(y_i-(\hat{a}_n+y_{i-1})\right)^2"/> is the sum of the square errors of the model 1 <a class="reference internal" href="#equation-model1">(2)</a> assuming <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-2">(6)</a> and <img class="math" src="../../_images/math/e2309b943f27f9546c799ec6bb5e54a629a68ad9.svg" alt="S_{1,b}=\sum_{i=2}^n\left(y_i-(\hat{a}_n+\hat{b}_nt_i+\hat{\rho}_ny_{i-1})\right)^2"/> is the same sum when we make no assumption on <img class="math" src="../../_images/math/87ace8ea2f1a9d6d4af85f73522c31b119b05e95.svg" alt="\rho"/> and <img class="math" src="../../_images/math/7a28565e2d8a0f1b90383ada07f80ec18c374992.svg" alt="b"/>.</p>
<p>The statistics <img class="math" src="../../_images/math/6816c9b04bba8decc8a8c063405670e3d6220da6.svg" alt="\hat{F}_1"/> converges in distribution to the Fisher-Snedecor distribution <a class="reference internal" href="../../user_manual/_generated/openturns.FisherSnedecor.html#openturns.FisherSnedecor" title="openturns.FisherSnedecor"><code class="xref py py-class docutils literal notranslate"><span class="pre">FisherSnedecor</span></code></a> with <img class="math" src="../../_images/math/010eab7b2674e8d0c67997fb8d552e701ccf0222.svg" alt="d_1=2, d_2=n-3"/>. The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted when <img class="math" src="../../_images/math/64e5e873baf57342f56f9fff9016aeca6eab9a6c.svg" alt="\hat{F}_1 &lt; \Phi_{\alpha}"/> where <img class="math" src="../../_images/math/e01f663322252c9f440625b7579360aaba429a0f.svg" alt="\Phi_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/76b5e485f3e9e29ec4dde654fb6b9d110213a6f5.svg" alt="\alpha"/>.</p>
<dl class="docutils">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-2">(6)</a> is rejected, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is confirmed since the presence of linear trend is confirmed. And the test <a class="reference internal" href="#equation-testmodel1">(4)</a> proved that the unit root is accepted: <img class="math" src="../../_images/math/5bdd3cbf849b7e787a0b6bb512eb100fa651e750.svg" alt="\rho = 1"/>. We then conclude that the model is: <img class="math" src="../../_images/math/3c6f8943ddb6b1e22bf25b3497babfb76f4cb864.svg" alt="\boldsymbol{X_t = a + bt + X_{t-1} + \varepsilon_{t}}"/> which is a <strong>non stationary model</strong>.</li>
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-2">(6)</a> is accepted, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is not confirmed, since the presence of the linear trend is rejected and the test <a class="reference internal" href="#equation-testmodel1">(4)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the second model</strong> <a class="reference internal" href="#equation-model2">(7)</a>.</li>
</ul>
</dd>
</dl>
<p><strong>2.</strong> We assume the model <a class="reference internal" href="#equation-model2">(7)</a>:</p>
<div class="math" id="equation-model2">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-model2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fe654f3c43aaa656eec3584083e53c14c7b6bb77.svg" alt="\boldsymbol{X_t = a + \rho X_{t-1} + \varepsilon_{t}}"/></p>
</div><p>The coefficients <img class="math" src="../../_images/math/85c2d6fa3127235b5c4b0437cb01e336934d7e65.svg" alt="(a,\rho)"/> are estimated as follows:</p>
<div class="math" id="equation-model2estim">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-model2estim" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f4f882d6ad09b0148085725e3301136c8d477340.svg" alt="\underbrace{\left(\begin{array}{lll}
   \displaystyle n-1 &amp;\sum_{i=2}^n y_{i-1}\\
   \displaystyle \sum_{i=2}^n y_{i-1} &amp;\sum_{i=2}^n y_{i-1}^2
                  \end{array}
 \right)}_{\mat{N}}
 \left(
  \begin{array}{c}
    \hat{a}_n\\
    \hat{\rho}_n
  \end{array}
 \right)=
 \left(
  \begin{array}{l}
    \displaystyle \sum_{i=1}^n y_{i} \\
    \displaystyle \sum_{i=2}^n y_{i-1} y_{i}
   \end{array}
 \right)"/></p>
</div><p>We first test:</p>
<div class="math" id="equation-testmodel2">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-testmodel2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d30327dda1b3d8d69173fdee61eba532f9cb88c3.svg" alt="\left\{
 \begin{array}{lr}
   \mathcal{H}_0: &amp; \rho = 1 \\
   \mathcal{H}_1: &amp; \rho &lt; 1
 \end{array}
 \right."/></p>
</div><p>thanks to the Student statistics:</p>
<div class="math">
<p><img src="../../_images/math/dbd727cfbfec8300a8507b51606d1ae7a9dc3852.svg" alt="t_{\rho=1} = \frac{\rho_n-1}{\sigma_{\rho_n}}"/></p>
</div><p>where <img class="math" src="../../_images/math/512e96c686a4fd1776c3ffd78b50b21cb199c029.svg" alt="\sigma_{\rho_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/253f79e431ebb1120f97e2ce9b8c8d6a83351700.svg" alt="\Hat{\rho}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/3a6d46f6fcbb5a3633b9b4e04493af95d2bfa155.svg" alt="\sigma_{\rho_n}=\mat{N}^{-1}_{22}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><p>which converges in distribution to the Dickey-Fuller distribution associated to the model with drift and no linear trend:</p>
<div class="math">
<p><img src="../../_images/math/fe72a9235493c51d697d2d5876768931c9c6b53a.svg" alt="t_{\rho = 1} \stackrel{\mathcal{L}}{\longrightarrow} \frac{\int_{0}^{1}W^{a}(r) \di{W(r)}}{\int_{1}^{0} W^{a}(r)^2 \di{r}}"/></p>
</div><p>The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel2">(9)</a> is accepted when <img class="math" src="../../_images/math/af3ba8266e948cfd29ef8a4bd948d6d9e1e9765d.svg" alt="t_{\rho=1} &gt; C_{\alpha}"/> where <img class="math" src="../../_images/math/8683399d17ea6912bd9218714c693981d1c45c7d.svg" alt="C_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/76b5e485f3e9e29ec4dde654fb6b9d110213a6f5.svg" alt="\alpha"/>.</p>
<p>The quantiles of the Dickey-Fuller statistics for the model with drift are:</p>
<div class="math">
<p><img src="../../_images/math/bda72c78580d65b9fafb169f90c482251cf013a3.svg" alt="\left\{
\begin{array}{ll}
    \alpha = 0.01, &amp; C_{\alpha} = -3.43 \\
    \alpha = 0.05, &amp; C_{\alpha} = -2.86 \\
    \alpha = 0.10, &amp; C_{\alpha} = -2.57
\end{array}
\right."/></p>
</div><p><strong>2.1. Case 1:</strong> The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel2">(9)</a> is rejected</p>
<p>We test whether <img class="math" src="../../_images/math/68875d9854e4c7baaf69115e61eada82ff5420c7.svg" alt="a=0"/>:</p>
<div class="math" id="equation-testsousmodele2-1">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-testsousmodele2-1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/a5bba14489989d04189b921b229fa9d06119902c.svg" alt="\left\{
\begin{array}{lr}
  \mathcal{H}_0: &amp; a = 0 \\
  \mathcal{H}_1: &amp; a \neq 0
\end{array}
\right."/></p>
</div><p>where the statistics <img class="math" src="../../_images/math/8ff0470e30929048f4086e62075d9c40b2d26d78.svg" alt="t_n = \frac{|\hat{a}_n|}{\sigma_{a_n}}"/> converges in distribution to the Student distribution <a class="reference internal" href="../../user_manual/_generated/openturns.Student.html#openturns.Student" title="openturns.Student"><code class="xref py py-class docutils literal notranslate"><span class="pre">Student</span></code></a> with <img class="math" src="../../_images/math/65f121d27bf2b79342e10d1f811b8e6ab8bcaee0.svg" alt="\nu=n-3"/>, where <img class="math" src="../../_images/math/639791ff97067111b439e8a4fc393157389dda98.svg" alt="\sigma_{a_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/60be731d1107571f8509a13c24cb99243fc9dbb8.svg" alt="\Hat{a}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/87dd33de310068b3d1ba87fc9d4f084d17208690.svg" alt="\sigma_{a_n}=\mat{N}^{-1}_{11}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><dl class="docutils">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-1">(10)</a> is rejected, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is confirmed. And the test <a class="reference internal" href="#equation-testmodel2">(9)</a> proved that the unit root is rejected: <img class="math" src="../../_images/math/086af165e19fd35175fffae6670422fcbea0cf82.svg" alt="\rho &lt; 1"/>. We then conclude that the final model is: <img class="math" src="../../_images/math/38c3bc148b2282cbf1153741227a078c835c0504.svg" alt="\boldsymbol{X_t = a + \rho X_{t-1} + \varepsilon_{t}}"/> with <img class="math" src="../../_images/math/3627c584f936a8be950e9a40ec981345b6e68ead.svg" alt="\boldsymbol{\rho &lt; 1}"/> which is a <strong>stationary model</strong>.</li>
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-1">(10)</a> is accepted, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is not confirmed, since the drift presence is rejected and the test <a class="reference internal" href="#equation-testmodel1">(4)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the third model</strong> <a class="reference internal" href="#equation-model3">(12)</a>.</li>
</ul>
</dd>
</dl>
<p><strong>2.2. Case 2:</strong> The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel2">(9)</a> is accepted</p>
<p>We test whether <img class="math" src="../../_images/math/e7b0944552ffab66ecc008f991ea84182329b215.svg" alt="(\rho, a) = (1,0)"/>:</p>
<div class="math" id="equation-testsousmodele2-2">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-testsousmodele2-2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/874db213f42e4942f798ee45c84c0c90a817a891.svg" alt="\left\{
\begin{array}{lr}
  \mathcal{H}_0: &amp; (\rho, a) = (1,0) \\
  \mathcal{H}_1: &amp; (\rho, a) \neq (1,0)
\end{array}
\right."/></p>
</div><p>with a Fisher test. The statistics is:</p>
<div class="math">
<p><img src="../../_images/math/fdcb2c5242381146fb2bc1552295a7c596c427df.svg" alt="\displaystyle \hat{F}_2 = \frac{(SCR_{2,c} - SCR_{2})/2}{SCR_{2}/(n-2)}"/></p>
</div><p>where <img class="math" src="../../_images/math/77987435197eeed4e36c11be34523f2b701f66e4.svg" alt="SCR_{2,c}"/> is the sum of the square errors of the model 2 <a class="reference internal" href="#equation-model2">(7)</a> assuming <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-2">(11)</a> and <img class="math" src="../../_images/math/1c6971f33a5d3d8b27e4d9b04477384156550346.svg" alt="SCR_{2}"/> is the same sum when we make no assumption on <img class="math" src="../../_images/math/87ace8ea2f1a9d6d4af85f73522c31b119b05e95.svg" alt="\rho"/> and <img class="math" src="../../_images/math/69f1be4af39fdd172c6af6b4eff109ffa69e5b80.svg" alt="a"/>.</p>
<p>The statistics <img class="math" src="../../_images/math/dbb6e0c9de576afb5555e44b504bb6c65a8a19ec.svg" alt="\hat{F}_2"/> converges in distribution to the Fisher-Snedecor distribution <a class="reference internal" href="../../user_manual/_generated/openturns.FisherSnedecor.html#openturns.FisherSnedecor" title="openturns.FisherSnedecor"><code class="xref py py-class docutils literal notranslate"><span class="pre">FisherSnedecor</span></code></a> with <img class="math" src="../../_images/math/5b0bf2936bf24e978f5cf0b3f84993ee6052cc47.svg" alt="d_1=2, d_2=n-2"/>. The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted if when <img class="math" src="../../_images/math/1d80a29426edc0a515b2ba8594836c4bd33d6ddc.svg" alt="\hat{F}_2 &lt; \Phi_{\alpha}"/> where <img class="math" src="../../_images/math/e01f663322252c9f440625b7579360aaba429a0f.svg" alt="\Phi_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/76b5e485f3e9e29ec4dde654fb6b9d110213a6f5.svg" alt="\alpha"/>.</p>
<dl class="docutils">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-2">(11)</a> is rejected, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is confirmed since the presence of the drift is confirmed. And the test <a class="reference internal" href="#equation-testmodel2">(9)</a> proved that the unit root is accepted: <img class="math" src="../../_images/math/18d929dd4a0415aeb1c5041f8e0eed76652e36ee.svg" alt="\rho =1"/>. We then conclude that the model is: <img class="math" src="../../_images/math/e6c324fa6953d8026923390696ed5d4bfbc86245.svg" alt="\boldsymbol{X_t = a + X_{t-1} + \varepsilon_{t}}"/> which is a <strong>non stationary model</strong>.</li>
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-2">(11)</a> is accepted, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is not confirmed, since the drift presence is rejected and the test <a class="reference internal" href="#equation-testmodel2">(9)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the third model</strong> <a class="reference internal" href="#equation-model3">(12)</a>.</li>
</ul>
</dd>
</dl>
<p><strong>3.</strong> We assume the model <a class="reference internal" href="#equation-model3">(12)</a>:</p>
<div class="math" id="equation-model3">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-model3" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d951247ac4c0c0faae34699bf6b8814cfeab6d7e.svg" alt="\boldsymbol{X_t = \rho X_{t-1} + \varepsilon_{t}}"/></p>
</div><p>The coefficients <img class="math" src="../../_images/math/87ace8ea2f1a9d6d4af85f73522c31b119b05e95.svg" alt="\rho"/> are estimated as follows:</p>
<div class="math" id="equation-model3estim">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-model3estim" title="Permalink to this equation">¶</a></span><img src="../../_images/math/24f0409675b77dadf9a356da5494857a70c84142.svg" alt="\hat{\rho}_n=\frac{\sum_{i=2}^ny_{i-1}y_i}{\sum_{i=2}^ny_{i-1}^2}"/></p>
</div><p>We first test:</p>
<div class="math" id="equation-testmodel3">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-testmodel3" title="Permalink to this equation">¶</a></span><img src="../../_images/math/edc1f830d987599a4f6fd550d5825ba7368c1600.svg" alt="\left\{
\begin{array}{lr}
  \mathcal{H}_0: &amp; \rho = 1 \\
  \mathcal{H}_1: &amp; \rho &lt; 1
\end{array}
\right."/></p>
</div><p>thanks to the Student statistics:</p>
<div class="math">
<p><img src="../../_images/math/a81cb50386b9cfc287e24073528b3fbae8d72029.svg" alt="t_{\rho=1} = \frac{\hat{\rho}_n-1}{\sigma_{\rho_n}}"/></p>
</div><p>where <img class="math" src="../../_images/math/512e96c686a4fd1776c3ffd78b50b21cb199c029.svg" alt="\sigma_{\rho_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/253f79e431ebb1120f97e2ce9b8c8d6a83351700.svg" alt="\Hat{\rho}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/1bacc8c8e617243e1a0d07cbf9d68657aaf24a13.svg" alt="\sigma_{\rho_n}=\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-\hat{\rho}_ny_{i-1}\right)^2}/\sqrt{\sum_{i=2}^ny_{i-1}^2}"/></p>
</div><p>which converges in distribution to the Dickey-Fuller distribution associated to the random walk model:</p>
<div class="math">
<p><img src="../../_images/math/0c965fb750afe718232a33849f4cee514ecec175.svg" alt="t_{\rho = 1} \stackrel{\mathcal{L}}{\longrightarrow} \frac{\int_{0}^{1}W(r) \di{W(r)}}{\int_{1}^{0} W(r)^2 \di{r}}"/></p>
</div><p>The null hypothesis <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel3">(14)</a> is accepted when <img class="math" src="../../_images/math/af3ba8266e948cfd29ef8a4bd948d6d9e1e9765d.svg" alt="t_{\rho=1} &gt; C_{\alpha}"/> where <img class="math" src="../../_images/math/8683399d17ea6912bd9218714c693981d1c45c7d.svg" alt="C_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/76b5e485f3e9e29ec4dde654fb6b9d110213a6f5.svg" alt="\alpha"/>.</p>
<p>The quantiles of the Dickey-Fuller statistics for the random walk model are:</p>
<div class="math">
<p><img src="../../_images/math/e49a317a8772e3ce40c547cf89ee517d3ff98f14.svg" alt="\left\{
\begin{array}{ll}
    \alpha = 0.01, &amp; C_{\alpha} = -2.57 \\
    \alpha = 0.05, &amp; C_{\alpha} = -1.94 \\
    \alpha = 0.10, &amp; C_{\alpha} = -1.62
\end{array}
\right."/></p>
</div><dl class="docutils">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel3">(14)</a> is rejected, we then conclude that the model is : <img class="math" src="../../_images/math/97eb0250757770bb5d23011a8650f66bc8a6b722.svg" alt="\boldsymbol{X_t = \rho X_{t-1} + \varepsilon_{t}}"/> where <img class="math" src="../../_images/math/086af165e19fd35175fffae6670422fcbea0cf82.svg" alt="\rho &lt; 1"/> which is a <strong>stationary model</strong>.</li>
<li>If <img class="math" src="../../_images/math/8784431b966f7be1ddcf9dc778d988925c0c37f2.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel3">(14)</a> is accepted, we then conclude that the model is: <img class="math" src="../../_images/math/9ff77192e33d539abbd638504f1b798e79abe839.svg" alt="\boldsymbol{X_t = X_{t-1} + \varepsilon_{t}}"/> which is a <strong>non stationary model</strong>.</li>
</ul>
</dd>
</dl>
<div class="topic">
<p class="topic-title first">API:</p>
<ul class="simple">
<li>See <a class="reference internal" href="../../user_manual/_generated/openturns.DickeyFullerTest.html#openturns.DickeyFullerTest" title="openturns.DickeyFullerTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DickeyFullerTest</span></code></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../meta_modeling/meta_modeling.html" title="Meta modeling"
             >next</a> |</li>
        <li class="right" >
          <a href="process_transformation.html" title="Process transformation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="probabilistic_modeling.html" >Probabilistic modeling</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2018 Airbus-EDF-IMACS-Phimeca.
      Last updated on Jan 01, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.0+/fa003c62b.
    </div>
  </body>
</html>